cmake_minimum_required(VERSION 3.10)
project(hdrhistogram)
set(STD -std=c99)
set(WARN -Wall)
set(OPT -Os)
set(R_CFLAGS ${STD} ${WARN} ${OPT} ${DEBUG} ${CFLAGS} -DHDR_MALLOC_INCLUDE=\"hdr_redis_malloc.h\")
set(R_LDFLAGS ${LDFLAGS})
set(DEBUG -g)
set(R_CC ${CC} ${R_CFLAGS})
set(R_LD ${CC} ${R_LDFLAGS})
set(AR ar)
set(ARFLAGS rcs)
add_library(hdr_histogram STATIC hdr_histogram.c)
target_include_directories(hdr_histogram PUBLIC ${CMAKE_CURRENT_SOURCE_DIR})
target_compile_options(hdr_histogram PUBLIC ${R_CFLAGS})

# add_executable(hdr_histogram_test hdr_histogram_test.c)
# target_link_libraries(hdr_histogram_test hdrhistogram)

# add_custom_target(clean COMMAND rm -f *.o *.a)